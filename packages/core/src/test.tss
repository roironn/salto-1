import _ from 'lodash'
import { parse } from './parser/parse'
import { Element } from 'adapter-api'
import { dump } from './parser/dump'
import fs from 'fs'
import { deserialize } from './serializer/elements'

const fn =`
salto 
  name = "asdasd"
  uid  = "b0f71c1e-183e-48df-8181-6dc50df4f60f"
}
`
const test = async () => {
    let d: string
    const e = (await parse(Buffer.from(fn), ''))
    console.log(JSON.stringify(e, null, 2))
    // d = await dump(e)
    // console.log(d)
    // console.log("============")
    // e = (await parse(Buffer.from(d), '')).elements
    // d = await dump(e)
    // console.log(d)
    // console.log("============")
    // const data = fs.readFileSync('/Users/roironn/new_test/cap/sf_adapter_res.bpc', 'utf8')
    // const elements = deserialize(data)
    // const fil = elements.filter(e => e.elemID.getFullName().indexOf('opp__stage__cascade_to__contact') !== -1)
    // const d = await dump(fil)
    // const e = await parse(Buffer.from(d), '')
    // console.log(e)
    // console.log(await dump(e.elements))
}

Promise.all([test()])
